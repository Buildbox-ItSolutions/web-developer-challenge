"use strict";var e=require("autoprefixer"),s=require("cssdb"),t=require("fs"),o=require("path"),r=require("postcss-attribute-case-insensitive"),i=require("css-blank-pseudo"),n=require("postcss-color-functional-notation"),c=require("postcss-color-hex-alpha"),a=require("postcss-color-rebeccapurple"),u=require("postcss-custom-media"),l=require("postcss-custom-properties"),p=require("postcss-custom-selectors"),f=require("postcss-dir-pseudo-class"),d=require("postcss-double-position-gradients"),m=require("postcss-env-function"),g=require("postcss-focus-visible"),b=require("postcss-focus-within"),h=require("postcss-font-variant"),y=require("postcss-gap-properties"),w=require("css-has-pseudo"),v=require("postcss-image-set-function"),$=require("postcss-initial"),q=require("postcss-lab-function"),k=require("postcss-logical"),O=require("postcss-media-minmax"),S=require("postcss-nesting"),j=require("postcss-overflow-shorthand"),x=require("postcss-page-break"),E=require("postcss-place"),P=require("css-prefers-color-scheme"),M=require("postcss-pseudo-class-any-link"),_=require("postcss-replace-overflow-wrap"),R=require("postcss-selector-not"),A=require("@csstools/postcss-is-pseudo-class"),F=require("@csstools/postcss-hwb-function"),N=require("postcss-opacity-percentage"),T=require("postcss-clamp"),B=require("@csstools/postcss-font-format-keywords"),U=require("@csstools/postcss-normalize-display-values"),W=require("browserslist");function C(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var I=C(e),V=C(s),D=C(t),L=C(o),J=C(r),z=C(i),G=C(n),H=C(c),K=C(a),Q=C(u),X=C(l),Y=C(p),Z=C(f),ee=C(d),se=C(m),te=C(g),oe=C(b),re=C(h),ie=C(y),ne=C(w),ce=C(v),ae=C($),ue=C(q),le=C(k),pe=C(O),fe=C(S),de=C(j),me=C(x),ge=C(E),be=C(P),he=C(M),ye=C(_),we=C(R),ve=C(A),$e=C(F),qe=C(N),ke=C(T),Oe=C(B),Se=C(U),je=C(W);async function xe(e,s,t,o){const r=function(e){return`:root {\n${Object.keys(e).reduce(((s,t)=>(s.push(`\t${t}: ${e[t]};`),s)),[]).join("\n")}\n}\n`}(t),i=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-media ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(s),n=function(e){return`${Object.keys(e).reduce(((s,t)=>(s.push(`@custom-selector ${t} ${e[t]};`),s)),[]).join("\n")}\n`}(o),c=`${i}\n${n}\n${r}`;await Re(e,c)}function Ee(e,s){return`\n\t${e}: {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t\t'${Ae(t)}': '${Ae(s[t])}'`),e)),[]).join(",\n")}\n\t}`}function Pe(e,s){return`export const ${e} = {\n${Object.keys(s).reduce(((e,t)=>(e.push(`\t'${Ae(t)}': '${Ae(s[t])}'`),e)),[]).join(",\n")}\n};\n`}function Me(e,s){return Promise.all([].concat(s).map((async s=>{if(s instanceof Function)await s({customMedia:_e(e.customMedia),customProperties:_e(e.customProperties),customSelectors:_e(e.customSelectors)});else{const t=s===Object(s)?s:{to:String(s)},o=t.toJSON||_e;if("customMedia"in t||"customProperties"in t||"customSelectors"in t)t.customMedia=o(e.customMedia),t.customProperties=o(e.customProperties),t.customSelectors=o(e.customSelectors);else if("custom-media"in t||"custom-properties"in t||"custom-selectors"in t)t["custom-media"]=o(e.customMedia),t["custom-properties"]=o(e.customProperties),t["custom-selectors"]=o(e.customSelectors);else{const s=String(t.to||""),r=(t.type||L.default.extname(t.to).slice(1)).toLowerCase(),i=o(e.customMedia),n=o(e.customProperties),c=o(e.customSelectors);"css"===r&&await xe(s,i,n,c),"js"===r&&await async function(e,s,t,o){const r=`module.exports = {${Ee("customMedia",s)},${Ee("customProperties",t)},${Ee("customSelectors",o)}\n};\n`;await Re(e,r)}(s,i,n,c),"json"===r&&await async function(e,s,t,o){const r=`${JSON.stringify({"custom-media":s,"custom-properties":t,"custom-selectors":o},null,"  ")}\n`;await Re(e,r)}(s,i,n,c),"mjs"===r&&await async function(e,s,t,o){const r=`${Pe("customMedia",s)}\n${Pe("customProperties",t)}\n${Pe("customSelectors",o)}`;await Re(e,r)}(s,i,n,c)}}})))}function _e(e){return Object.keys(e).reduce(((s,t)=>(s[t]=String(e[t]),s)),{})}function Re(e,s){return new Promise(((t,o)=>{D.default.writeFile(e,s,(e=>{e?o(e):t()}))}))}function Ae(e){return e.replace(/\\([\s\S])|(')/g,"\\$1$2").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}function Fe(){return{postcssPlugin:"postcss-system-ui-font",Declaration(e){Ne.test(e.prop)&&(e.value.includes(Be.join(", "))||(e.value=e.value.replace(Ue,We)))}}}Fe.postcss=!0;const Ne=/(?:^(?:-|\\002d){2})|(?:^font(?:-family)?$)/i,Te="[\\f\\n\\r\\x09\\x20]",Be=["system-ui","-apple-system","Segoe UI","Roboto","Ubuntu","Cantarell","Noto Sans","sans-serif"],Ue=new RegExp(`(^|,|${Te}+)(?:system-ui${Te}*)(?:,${Te}*(?:${Be.join("|")})${Te}*)?(,|$)`,"i"),We=`$1${Be.join(", ")}$2`,Ce={"css-blank-pseudo":"blank-pseudo-class","css-has-pseudo":"has-pseudo-class","css-prefers-color-scheme":"prefers-color-scheme-query","postcss-attribute-case-insensitive":"case-insensitive-attributes","postcss-clamp":"clamp","postcss-color-functional-notation":"color-functional-notation","postcss-color-hex-alpha":"hexadecimal-alpha-notation","postcss-color-rebeccapurple":"rebeccapurple-color","postcss-custom-media":"custom-media-queries","postcss-custom-properties":"custom-properties","postcss-custom-selectors":"custom-selectors","postcss-dir-pseudo-class":"dir-pseudo-class","postcss-double-position-gradients":"double-position-gradients","postcss-env-function":"environment-variables","postcss-focus-visible":"focus-visible-pseudo-class","postcss-focus-within":"focus-within-pseudo-class","postcss-font-format-keywords":"font-format-keywords","postcss-font-variant":"font-variant-property","postcss-gap-properties":"gap-properties","postcss-hwb-function":"hwb-function","postcss-image-set-function":"image-set-function","postcss-initial":"all-property","postcss-is-pseudo-class":"is-pseudo-class","postcss-lab-function":"lab-function","postcss-logical":"logical-properties-and-values","postcss-media-minmax":"media-query-ranges","postcss-nesting":"nesting-rules","postcss-normalize-display-values":"display-two-values","postcss-opacity-percentage":"opacity-percentage","postcss-overflow-shorthand":"overflow-property","postcss-page-break":"break-properties","postcss-place":"place-properties","postcss-pseudo-class-any-link":"any-link-pseudo-class","postcss-replace-overflow-wrap":"overflow-wrap-property","postcss-selector-not":"not-pseudo-class","postcss-system-ui-font-family":"system-ui-font-family"},Ie=(()=>{const e={};for(const[s,t]of Object.entries(Ce))e[t]=s;return e})(),Ve=new Map([["all-property",ae.default],["any-link-pseudo-class",he.default],["blank-pseudo-class",z.default],["break-properties",me.default],["case-insensitive-attributes",J.default],["clamp",ke.default],["color-functional-notation",G.default],["custom-media-queries",Q.default],["custom-properties",X.default],["custom-selectors",Y.default],["dir-pseudo-class",Z.default],["display-two-values",Se.default],["double-position-gradients",ee.default],["environment-variables",se.default],["focus-visible-pseudo-class",te.default],["focus-within-pseudo-class",oe.default],["font-format-keywords",Oe.default],["font-variant-property",re.default],["gap-properties",ie.default],["hwb-function",$e.default],["has-pseudo-class",ne.default],["hexadecimal-alpha-notation",H.default],["image-set-function",ce.default],["is-pseudo-class",ve.default],["lab-function",ue.default],["logical-properties-and-values",le.default],["media-query-ranges",pe.default],["nesting-rules",fe.default],["not-pseudo-class",we.default],["opacity-percentage",qe.default],["overflow-property",de.default],["overflow-wrap-property",ye.default],["place-properties",ge.default],["prefers-color-scheme-query",be.default],["rebeccapurple-color",K.default],["system-ui-font-family",Fe]]);function De(e,s){let t="unknown",o=1/0;for(let r=0;r<s.length;r++){const i=Le(e,s[r]);i<o&&(o=i,t=s[r])}return{mostSimilar:t,distance:o}}function Le(e,s){if(!e.length)return s.length;if(!s.length)return e.length;const t=[];for(let o=0;o<=s.length;o++){t[o]=[o];for(let r=1;r<=e.length;r++)t[o][r]=0===o?r:Math.min(t[o-1][r]+1,t[o][r-1]+1,t[o-1][r-1]+(e[r-1]===s[o-1]?0:1))}return t[s.length][e.length]}class Je{constructor(){this.logs=[]}log(e){this.logs.push(e)}resetLogger(){this.logs.length=0}dumpLogs(e){e&&this.logs.forEach((s=>e.warn(s))),this.resetLogger()}}const ze={"blank-pseudo-class":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-blank-pseudo/README-BROWSER.md","focus-visible-pseudo-class":"https://github.com/WICG/focus-visible","focus-within-pseudo-class":"https://github.com/jsxtools/focus-within/blob/master/README-BROWSER.md","has-pseudo-class":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-has-pseudo/README-BROWSER.md","prefers-color-scheme-query":"https://github.com/csstools/postcss-plugins/blob/main/plugins/css-prefers-color-scheme/README-BROWSER.md"},Ge=["blank-pseudo-class","focus-visible-pseudo-class","focus-within-pseudo-class","has-pseudo-class","prefers-color-scheme-query"];function He(e,s){if(!e)return!1;if("string"==typeof e)return!0;if(Array.isArray(e)){for(let t=0;t<e.length;t++){if("string"==typeof e[t])return!0;if(e[t]&&s in Object(e[t]))return!0}return!1}return s in Object(e)}function Ke(e,s,t){return Math.max(e,Math.min(s,t))}const Qe=Symbol("insertBefore"),Xe=Symbol("insertAfter"),Ye=Symbol("insertOrder"),Ze=Symbol("plugin");function es(e,s,t){if("insertBefore"!==t&&"insertAfter"!==t)return[];const o="insertBefore"===t?Qe:Xe,r=[];for(const t in s){if(!Object.hasOwnProperty.call(s,t))continue;if(!e.find((e=>e.id===t)))continue;let i=s[t];Array.isArray(i)||(i=[i]);for(let e=0;e<i.length;e++)r.push({id:t,[Ze]:i[e],[Ye]:e,[o]:!0})}return r}var ss=["custom-media-queries","custom-properties","environment-variables","image-set-function","media-query-ranges","prefers-color-scheme-query","nesting-rules","custom-selectors","any-link-pseudo-class","case-insensitive-attributes","focus-visible-pseudo-class","focus-within-pseudo-class","not-pseudo-class","logical-properties-and-values","dir-pseudo-class","all-property","color-functional-notation","double-position-gradients","hexadecimal-alpha-notation","hwb-function","lab-function","rebeccapurple-color","blank-pseudo-class","break-properties","font-variant-property","is-pseudo-class","has-pseudo-class","gap-properties","overflow-property","overflow-wrap-property","place-properties","system-ui-font-family"];function ts(e,s,t){return e.concat(es(e,s,"insertBefore"),es(e,t,"insertAfter")).filter((e=>function(e){return!!e[Qe]||!!e[Xe]||!!Ve.has(e.id)}(e))).sort(((e,s)=>function(e,s){return e.id===s.id?e[Qe]&&s[Qe]||e[Xe]&&s[Xe]?Ke(-1,e[Ye]-s[Ye],1):e[Qe]||s[Xe]?-1:e[Xe]||s[Qe]?1:0:Ke(-1,ss.indexOf(e.id)-ss.indexOf(s.id),1)}(e,s)))}const os=["ie","edge","firefox","chrome","safari","opera","ios_saf","android","op_mob","and_chr","and_ff","and_uc","samsung","and_qq","baidu","kaios"];function rs(e){if(!e)return[];if(!("browser_support"in e))return["> 0%"];const s=[];return os.forEach((t=>{const o=e.browser_support[t];"string"==typeof o&&/^[0-9|.]+$/.test(o)?s.push(`${t} < ${e.browser_support[t]}`):s.push(`${t} >= 1`)})),s}function is(e,s,t,o){const r=je.default(e,{ignoreUnknownVersions:!0});switch(s.id){case"is-pseudo-class":return{onComplexSelector:"warning"};case"nesting-rules":if(function(e,s){const t=rs(e);if(s.some((e=>je.default(t,{ignoreUnknownVersions:!0}).some((s=>s===e)))))return!0;return!1}(t.find((e=>"is-pseudo-class"===e.id)),r))return o.log('Disabling :is on "nesting-rules" due to lack of browser support.'),{noIsPseudoSelector:!0};return{};case"any-link-pseudo-class":if(r.find((e=>e.startsWith("ie ")||e.startsWith("edge "))))return o.log('Adding area[href] fallbacks for ":any-link" support in Edge and IE.'),{subFeatures:{areaHrefNeedsFixing:!0}};return{};default:return{}}}function ns(e,s,t,o){const r=Object(s.features),i=!("enableClientSidePolyfills"in s)||s.enableClientSidePolyfills,n=Object(s.insertBefore),c=Object(s.insertAfter),a=s.browsers,u=Ke(0,function(e){const s=parseInt(e,10);return Number.isNaN(s)?0:s}(s.minimumVendorImplementations),3);u>0&&o.log(`Using features with ${u} or more vendor implementations`);const l=function(e,s){let t=2;if(void 0===e.stage)return s.log(`Using features from Stage ${t} (default)`),t;if(!1===e.stage)t=5;else{let s=parseInt(e.stage,10);Number.isNaN(s)&&(s=0),t=Ke(0,s,5)}return 5===t?s.log('Stage has been disabled, features will be handled via the "features" option.'):s.log(`Using features from Stage ${t}`),t}(s,o);2===l&&t&&!1===t.preserve&&(e=JSON.parse(JSON.stringify(e))).forEach((e=>{("blank-pseudo-class"===e.id||"prefers-color-scheme-query"===e.id)&&(e.stage=1)}));const p=ts(e,n,c).map((e=>function(e){const s=rs(e);if(e[Qe]||e[Xe]){let t=e.id;return t=e.insertBefore?`before-${t}`:`after-${t}`,{browsers:s,vendors_implementations:e.vendors_implementations,plugin:e[Ze],id:t,stage:6}}return{browsers:s,vendors_implementations:e.vendors_implementations,plugin:Ve.get(e.id),id:e.id,stage:e.stage}}(e))).filter((e=>0===u||(!(!e[Qe]&&!e[Xe])||(u<=e.vendors_implementations||(o.log(`  ${e.id} with ${e.vendors_implementations} vendor implementations has been disabled`),!1))))).filter((e=>{const s=e.stage>=l,t=i||!Ge.includes(e.id),n=!1===r[e.id],c=r[e.id]?r[e.id]:s&&t;return n?o.log(`  ${e.id} has been disabled by options`):s?t||o.log(`  ${e.id} has been disabled by "enableClientSidePolyfills: false".`):c?o.log(`  ${e.id} has been enabled by options`):o.log(`  ${e.id} with stage ${e.stage} has been disabled`),c})).map((s=>function(e,s,t,o,r,i){let n,c;return n=is(s,o,e,i),!0===t[o.id]?r&&(n=Object.assign({},n,r)):n=r?Object.assign({},n,r,t[o.id]):Object.assign({},n,t[o.id]),c=o.plugin.postcss&&"function"==typeof o.plugin?o.plugin(n):o.plugin&&o.plugin.default&&"function"==typeof o.plugin.default&&o.plugin.default.postcss?o.plugin.default(n):o.plugin,{browsers:o.browsers,vendors_implementations:o.vendors_implementations,plugin:c,pluginOptions:n,id:o.id}}(e,a,r,s,t,o))),f=je.default(a,{ignoreUnknownVersions:!0});return p.filter((e=>{if(e.id in r)return r[e.id];if(function(e){if("importFrom"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(He(e.pluginOptions.importFrom,"customMedia"))return!0;break;case"custom-properties":if(He(e.pluginOptions.importFrom,"customProperties"))return!0;break;case"environment-variables":if(He(e.pluginOptions.importFrom,"environmentVariables"))return!0;break;case"custom-selectors":if(He(e.pluginOptions.importFrom,"customSelectors"))return!0}if("exportTo"in Object(e.pluginOptions))switch(e.id){case"custom-media-queries":if(He(e.pluginOptions.exportTo,"customMedia"))return!0;break;case"custom-properties":if(He(e.pluginOptions.exportTo,"customProperties"))return!0;break;case"environment-variables":if(He(e.pluginOptions.exportTo,"environmentVariables"))return!0;break;case"custom-selectors":if(He(e.pluginOptions.exportTo,"customSelectors"))return!0}return!1}(e))return!0;const s=je.default(e.browsers,{ignoreUnknownVersions:!0}),t=f.some((e=>s.some((s=>s===e))));return t||o.log(`${e.id} disabled due to browser support`),t}))}const cs=e=>{const s=new Je,t=Object(e),o=Object.keys(Object(t.features)),r=t.browsers,i=function(e){if("importFrom"in e||"exportTo"in e||"preserve"in e){const s={};return"importFrom"in e&&(s.importFrom=e.importFrom),"exportTo"in e&&(s.exportTo={customMedia:{},customProperties:{},customSelectors:{}}),"preserve"in e&&(s.preserve=e.preserve),s}return!1}(t),n=ns(V.default,t,i,s),c=n.map((e=>e.plugin));!1!==t.autoprefixer&&c.push(I.default(Object.assign({overrideBrowserslist:r},t.autoprefixer))),function(e,s,t){if(s.debug){t.log("Enabling the following feature(s):");const s=[];e.forEach((e=>{e.id.startsWith("before")||e.id.startsWith("after")?t.log(`  ${e.id} (injected via options)`):t.log(`  ${e.id}`),void 0!==ze[e.id]&&s.push(e.id)})),s.length&&(t.log("These feature(s) need a browser library to work:"),s.forEach((e=>t.log(` ${e}: ${ze[e]}`))))}}(n,t,s);const a=()=>({postcssPlugin:"postcss-preset-env",OnceExit:function(r,{result:n}){!function(e,s,t){const o=Object.keys(Ie),r=Object.keys(Ce);e.forEach((e=>{if(o.includes(e))return;const i=De(e,o),n=De(e,r);i.distance<n.distance?s.warn(t,`Unknown feature: "${e}" did you mean: "${i.mostSimilar}"`):s.warn(t,`Unknown feature: "${e}" did you mean: "${Ce[n.mostSimilar]}"`)}))}(o,r,n),t.debug&&s.dumpLogs(n),s.resetLogger(),t.exportTo&&Me(i.exportTo,e.exportTo)}});return a.postcss=!0,{postcssPlugin:"postcss-preset-env",plugins:[...c,a()]}};cs.postcss=!0,module.exports=cs;
